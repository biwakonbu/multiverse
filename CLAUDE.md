# CLAUDE.md

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§Claudeã‚³ãƒ¼ãƒ‰ã‚’æ“ä½œã™ã‚‹éš›ã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**agent-runner** ã¯ã€é–‹ç™ºã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚¿ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ»ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã™ã€‚ä»¥ä¸‹ã‚’çµ„ã¿åˆã‚ã›ã¦ã„ã¾ã™ï¼š
- **Meta-agent**: LLMï¼ˆGPT-4 Turboï¼‰ãŒã‚¿ã‚¹ã‚¯ã‚’è¨ˆç”»ãƒ»è©•ä¾¡
- **AgentRunner Core**: ã‚¿ã‚¹ã‚¯çŠ¶æ…‹ã¨å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã‚’ç®¡ç†ã™ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³
- **Worker Agents**: å®Ÿéš›ã®é–‹ç™ºä½œæ¥­ï¼ˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼‰ã‚’è¡Œã†CLIãƒ„ãƒ¼ãƒ«ï¼ˆä¾‹ï¼šCodex CLIï¼‰

Docker ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒã§å®‰å…¨ãƒ»å†ç¾æ€§é«˜ãå®Ÿè¡Œã•ã‚Œã€å…¨ã¦ã®å®Ÿè¡Œå±¥æ­´ã¯Markdownå½¢å¼ã®Task Noteï¼ˆ`.agent-runner/task-*.md`ï¼‰ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
agent-runner/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ agent-runner/
â”‚       â””â”€â”€ main.go              # CLIã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ core/                    # ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ â˜…è©³ç´°ã¯ core/CLAUDE.md ã‚’å‚ç…§
â”‚   â”‚   â”œâ”€â”€ runner.go            # FSM ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ context.go           # TaskContextãƒ»TaskStateå®šç¾©
â”‚   â”‚   â””â”€â”€ runner_test.go       # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ meta/                    # Meta-agenté€šä¿¡å±¤ â˜…è©³ç´°ã¯ meta/CLAUDE.md ã‚’å‚ç…§
â”‚   â”‚   â”œâ”€â”€ client.go            # OpenAI APIé€šä¿¡ãƒ»ãƒ¢ãƒƒã‚¯å®Ÿè£…
â”‚   â”‚   â””â”€â”€ protocol.go          # YAMLãƒ—ãƒ­ãƒˆã‚³ãƒ«å®šç¾©
â”‚   â”œâ”€â”€ worker/                  # Workerå®Ÿè¡Œãƒ»Dockerã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ â˜…è©³ç´°ã¯ worker/CLAUDE.md ã‚’å‚ç…§
â”‚   â”‚   â”œâ”€â”€ executor.go          # Worker CLIå®Ÿè¡Œã®æŠ½è±¡åŒ–
â”‚   â”‚   â””â”€â”€ sandbox.go           # Docker APIç®¡ç†
â”‚   â”œâ”€â”€ note/                    # Task Noteç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ writer.go            # Markdown ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‡ºåŠ›
â”‚   â””â”€â”€ mock/                    # ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯å®Ÿè£…
â”‚       â”œâ”€â”€ meta.go
â”‚       â”œâ”€â”€ worker.go
â”‚       â””â”€â”€ note.go
â”œâ”€â”€ pkg/
â”‚   â””â”€â”€ config/                  # å…¬é–‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆYAMLè¨­å®šï¼‰
â”‚       â””â”€â”€ config.go            # TaskConfigæ§‹é€ ä½“å®šç¾©
â”œâ”€â”€ test/                         # â˜…è©³ç´°ã¯ test/CLAUDE.md ã‚’å‚ç…§
â”‚   â”œâ”€â”€ CLAUDE.md                # ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ãƒ»å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ç²¾åº¦ç®¡ç†
â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â””â”€â”€ run_flow_test.go     # Mockçµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ sandbox/
â”‚   â”‚   â”œâ”€â”€ Dockerfile.test      # Docker Sandboxãƒ†ã‚¹ãƒˆç”¨è»½é‡ã‚¤ãƒ¡ãƒ¼ã‚¸
â”‚   â”‚   â””â”€â”€ sandbox_test.go      # Docker APIãƒ»ã‚³ãƒ³ãƒ†ãƒŠç®¡ç†ãƒ†ã‚¹ãƒˆï¼ˆ-tags=dockerï¼‰
â”‚   â””â”€â”€ codex/
â”‚       â””â”€â”€ codex_integration_test.go  # Codexçµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ-tags=codexï¼‰
â”œâ”€â”€ docs/                        # è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ AgentRunner-architecture.md
â”‚   â”œâ”€â”€ agentrunner-spec-v1.md
â”‚   â””â”€â”€ AgentRunner-impl-design-v1.md
â”œâ”€â”€ sandbox/
â”‚   â””â”€â”€ Dockerfile               # Workerå®Ÿè¡Œç’°å¢ƒï¼ˆCodex CLIï¼‰
â”œâ”€â”€ CLAUDE.md                    # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒªï¼‰
â”œâ”€â”€ GEMINI.md                    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ã¨èƒŒæ™¯
â”œâ”€â”€ TESTING.md                   # ãƒ†ã‚¹ãƒˆãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
â”œâ”€â”€ CODEX_TEST_README.md         # Codexçµ±åˆã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ go.mod                       # Goãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†
â”œâ”€â”€ go.sum
â”œâ”€â”€ sample_task_go.yaml          # Goãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”¨ã‚µãƒ³ãƒ—ãƒ«ã‚¿ã‚¹ã‚¯å®šç¾©
â””â”€â”€ test_codex_task.yaml         # Codexçµ±åˆãƒ†ã‚¹ãƒˆç”¨ã‚¿ã‚¹ã‚¯å®šç¾©
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²

| ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | å½¹å‰² | è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
|-----------|------|-----------------|
| `cmd/` | CLIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ | main.go ã®ã¿ |
| `internal/core/` | ã‚¿ã‚¹ã‚¯FSMã¨ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | [internal/core/CLAUDE.md](internal/core/CLAUDE.md) |
| `internal/meta/` | Meta-agentï¼ˆLLMï¼‰ã¨ã®é€šä¿¡å±¤ | [internal/meta/CLAUDE.md](internal/meta/CLAUDE.md) |
| `internal/worker/` | Workerå®Ÿè¡Œã¨Dockerç®¡ç† | [internal/worker/CLAUDE.md](internal/worker/CLAUDE.md) |
| `internal/note/` | ã‚¿ã‚¹ã‚¯å®Ÿè¡Œå±¥æ­´ã® Markdownå‡ºåŠ› | [internal/note/CLAUDE.md](internal/note/CLAUDE.md) |
| `internal/mock/` | ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯å®Ÿè£… | [internal/mock/CLAUDE.md](internal/mock/CLAUDE.md) |
| `pkg/config/` | YAMLè¨­å®šãƒ‘ãƒ¼ã‚¹ï¼ˆå†åˆ©ç”¨å¯èƒ½ï¼‰ | [pkg/config/CLAUDE.md](pkg/config/CLAUDE.md) |
| `test/` | **4æ®µéšãƒ†ã‚¹ãƒˆæˆ¦ç•¥**ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆâ†’Mockâ†’Dockerâ†’Codexï¼‰ | **[test/CLAUDE.md](test/CLAUDE.md)** |
| `docs/` | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ»ä»•æ§˜æ›¸ | è©³ç´°ãªè¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| `sandbox/` | Docker ã‚¤ãƒ¡ãƒ¼ã‚¸å®šç¾© | Codex CLI ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  |

## ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰

### ãƒ“ãƒ«ãƒ‰
```bash
# ãƒã‚¤ãƒŠãƒªã‚’ãƒ“ãƒ«ãƒ‰
go build ./cmd/agent-runner

# å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®š
go build -o agent-runner ./cmd/agent-runner
```

### ãƒ†ã‚¹ãƒˆ

**è©³ç´°ã¯ [test/CLAUDE.md](test/CLAUDE.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

```bash
# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆä¾å­˜ãªã—ã€é«˜é€Ÿï¼‰
go test ./...

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæ¨å¥¨ã€Docker + Codex CLI å¿…é ˆï¼‰
go test -tags=docker,codex -timeout=15m ./...

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
go test -coverprofile=coverage.out ./... && go tool cover -html=coverage.out
```

test/CLAUDE.md ã«ã¯ä»¥ä¸‹ã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š
- **4æ®µéšãƒ†ã‚¹ãƒˆæˆ¦ç•¥**: ãƒ¦ãƒ‹ãƒƒãƒˆ â†’ Mockçµ±åˆ â†’ Docker â†’ Codex
- **å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³é›†**: Table-driven testsã€PBTã€Mock/Stubã€Context-based testing
- **ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°æˆ¦ç•¥**: docker/codex ã‚¿ã‚°ã«ã‚ˆã‚‹æ®µéšçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **å®Œå…¨ãªã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**: æ—¥å¸¸é–‹ç™ºãƒ»çµ±åˆãƒ»ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ»ãƒ‡ãƒãƒƒã‚°
- **ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**: 8é …ç›®ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ç’°å¢ƒå¤‰æ•°ã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç­‰ï¼‰
- **ç²¾åº¦ç®¡ç†æ‰‹æ³•**: ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã€ä¸å¤‰æ¡ä»¶ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã€ä¸¦è¡Œå®Ÿè¡Œ
- **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: Dockeræœªèµ·å‹•ã€èªè¨¼ã‚¨ãƒ©ãƒ¼ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç­‰

### å®Ÿè¡Œ
```bash
# åŸºæœ¬çš„ãªå®Ÿè¡Œï¼ˆæ¨™æº–å…¥åŠ›ã‹ã‚‰YAMLã‚’èª­ã¿è¾¼ã‚€ï¼‰
./agent-runner < task.yaml

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‘ã‚¤ãƒ—
cat task.yaml | go run cmd/agent-runner/main.go
```

### Dockerï¼ˆWorkerå®Ÿè¡Œç’°å¢ƒï¼‰
```bash
# Codex worker ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’ãƒ“ãƒ«ãƒ‰
docker build -t agent-runner-codex:latest sandbox/

# Codexçµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
./run_codex_test.sh
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ä¸‰å±¤æ§‹é€ 
```
Meta-agent (LLM)
    â†• YAML ãƒ—ãƒ­ãƒˆã‚³ãƒ« â†•
AgentRunner Core (çŠ¶æ…‹ + TaskContext)
    â†• Exec + Docker â†•
Worker Agents (Codex CLIç­‰)
```

### ã‚¿ã‚¹ã‚¯çŠ¶æ…‹æ©Ÿæ¢°ï¼ˆFSMï¼‰
```
PENDING â†’ PLANNING â†’ RUNNING â†’ VALIDATING â†’ COMPLETE
                                              â†“
                                            FAILED
```

**ä¸»è¦ãªé·ç§»**:
- `PENDING â†’ PLANNING`: Meta-agentãŒPRDã‹ã‚‰å—ã‘å…¥ã‚Œæ¡ä»¶ï¼ˆACï¼‰ã‚’ç”Ÿæˆ
- `PLANNING â†’ RUNNING`: Meta-agentãŒworkerå®Ÿè¡Œã‚’è¦æ±‚
- `RUNNING â†’ VALIDATING`: Workerå®Ÿè¡ŒãŒå®Œäº†ã€Meta-agentãŒå®Œäº†ã‚’è©•ä¾¡
- `VALIDATING â†’ COMPLETE/FAILED`: ã‚¿ã‚¹ã‚¯å®Œäº†åˆ¤å®šã‚’æ±ºå®š

### ä¸»è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

#### `/internal/core` - ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³
- **runner.go**: ã‚¿ã‚¹ã‚¯FSMã®ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€TaskContextã®ç®¡ç†
- **context.go**: TaskContextï¼ˆPRDã€ACã€workerå®Ÿè¡Œã€metaå‘¼ã³å‡ºã—ï¼‰ã¨TaskStateã‚’å®šç¾©
- `gopter`ã‚’ä½¿ç”¨ã—ãŸçŠ¶æ…‹ä¸å¤‰æ¡ä»¶ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
- **è©³ç´°**: [internal/core/CLAUDE.md](internal/core/CLAUDE.md) - FSMé·ç§»ãƒ«ãƒ¼ãƒ«ã€ä¾å­˜æ€§æ³¨å…¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

#### `/internal/meta` - Meta-agent é€šä¿¡å±¤
- **client.go**: Meta-agentæ¨è«–ç”¨ã®OpenAI APIé€šä¿¡
- **protocol.go**: YAML ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ§‹é€ ï¼ˆ`PlanTaskResponse`ã€`NextActionResponse`ç­‰ï¼‰
- ãƒ¢ãƒƒã‚¯å®Ÿè£…ã«å¯¾å¿œï¼ˆ`kind: "mock"`ï¼‰
- **è©³ç´°**: [internal/meta/CLAUDE.md](internal/meta/CLAUDE.md) - YAMLãƒ—ãƒ­ãƒˆã‚³ãƒ«ä»•æ§˜ã€LLMé€šä¿¡ã€ãƒ¢ãƒƒã‚¯å®Ÿè£…

#### `/internal/worker` - Worker å®Ÿè¡Œã¨ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç®¡ç†
- **executor.go**: Worker CLIå®Ÿè¡Œã®æŠ½è±¡åŒ–
- **sandbox.go**: Docker APIç®¡ç†ï¼ˆã‚³ãƒ³ãƒ†ãƒŠä½œæˆã€execã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
  - ãƒªãƒã‚¸ãƒˆãƒªã¯`/workspace/project`ã«ãƒã‚¦ãƒ³ãƒˆ
  - èªè¨¼æƒ…å ±ã‚’è‡ªå‹•ãƒã‚¦ãƒ³ãƒˆï¼ˆ`~/.codex/auth.json`ï¼‰
- **è©³ç´°**: [internal/worker/CLAUDE.md](internal/worker/CLAUDE.md) - Dockerãƒã‚¦ãƒ³ãƒˆæˆ¦ç•¥ã€èªè¨¼ç®¡ç†ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### `/internal/note` - Task Note ç”Ÿæˆ
- **writer.go**: TaskContextã‹ã‚‰Markdown Task Noteã‚’ç”Ÿæˆ
- Go `text/template`ã«ã‚ˆã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹å‡ºåŠ›
- **è©³ç´°**: [internal/note/CLAUDE.md](internal/note/CLAUDE.md) - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­è¨ˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œã€æ‹¡å¼µã‚¬ã‚¤ãƒ‰

#### `/internal/mock` - ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯å®Ÿè£…
- **meta.go, worker.go, note.go**: Function Field Injection ãƒ‘ã‚¿ãƒ¼ãƒ³
- ä¾å­˜æ€§æ³¨å…¥ã‚’å®Ÿç¾ã—ã€å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ãªã—ã§ ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- **è©³ç´°**: [internal/mock/CLAUDE.md](internal/mock/CLAUDE.md) - è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã€ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã€æ‹¡å¼µã‚¬ã‚¤ãƒ‰

#### `/pkg/config` - è¨­å®šç®¡ç†
- **config.go**: ã‚¿ã‚¹ã‚¯è¨­å®šæ§‹é€ ä½“ï¼ˆYAMLãƒ‘ãƒ¼ã‚¹ï¼‰
- **è©³ç´°**: [pkg/config/CLAUDE.md](pkg/config/CLAUDE.md) - YAML ã‚¹ã‚­ãƒ¼ãƒã€ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æˆ¦ç•¥ã€æ‹¡å¼µã‚¬ã‚¤ãƒ‰

## ã‚¿ã‚¹ã‚¯ YAML å½¢å¼

```yaml
version: 1

task:
  id: "TASK-123"              # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆçœç•¥æ™‚ã¯è‡ªå‹•ç”Ÿæˆï¼‰
  title: "ã‚¿ã‚¹ã‚¯å"           # ã‚ªãƒ—ã‚·ãƒ§ãƒ³
  repo: "."                   # ä½œæ¥­å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒªï¼ˆç›¸å¯¾ãƒ‘ã‚¹ã¾ãŸã¯çµ¶å¯¾ãƒ‘ã‚¹ï¼‰

  prd:
    path: "./docs/prd.md"     # PRDãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã€ã¾ãŸã¯
    text: |                   # PRDãƒ†ã‚­ã‚¹ãƒˆã‚’ç›´æ¥åŸ‹ã‚è¾¼ã¿
      è¦ä»¶å®šç¾©...

  test:
    command: "npm test"       # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆè‡ªå‹•ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰ï¼‰
    cwd: "./"                 # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰

runner:
  meta:
    kind: "openai-chat"       # ã¾ãŸã¯ "mock"
    model: "gpt-4-turbo"      # LLMãƒ¢ãƒ‡ãƒ«å

  worker:
    kind: "codex-cli"
    docker_image: "agent-runner-codex:latest"
    max_run_time_sec: 1800    # å®Ÿè¡Œã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
    env:
      CODEX_API_KEY: "env:CODEX_API_KEY"  # ç’°å¢ƒå¤‰æ•°ã‚’å‚ç…§
```

**å‚è€ƒ**: [sample_task_go.yaml](sample_task_go.yaml)ã€[test_codex_task.yaml](test_codex_task.yaml)

## é‡è¦ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

### ä¾å­˜æ€§æ³¨å…¥ï¼ˆDependency Injectionï¼‰
`Runner`æ§‹é€ ä½“ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆ`MetaClient`ã€`WorkerExecutor`ã€`NoteWriter`ï¼‰ã‚’å—ã‘å…¥ã‚Œã‚‹ãŸã‚ã€çµ±åˆä¾å­˜æ€§ãªã—ã§ãƒ¢ãƒƒã‚¯ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã™ã€‚

```go
type Runner struct {
    Config *config.TaskConfig
    Meta   MetaClient        // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    Worker WorkerExecutor    // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    Note   NoteWriter        // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
}
```

### TaskContext ã®ä¼æ’­
å®Ÿè¡ŒçŠ¶æ…‹ï¼ˆPRDã€å—ã‘å…¥ã‚Œæ¡ä»¶ã€workerçµæœã€metaå‘¼ã³å‡ºã—ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰å…¨ã¦ãŒå˜ä¸€ã®`TaskContext`æ§‹é€ ä½“ã§ä¿æŒã•ã‚Œã€FSMã‚’é€šã˜ã¦ä¼æ’­ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šå®Œå…¨ãªå†ç¾æ€§ã¨ç›£æŸ»è¨¼è·¡ï¼ˆTask Noteã«è¨˜éŒ²ï¼‰ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚

### Sandbox éš”é›¢
- ã‚¿ã‚¹ã‚¯1ã¤ã‚ãŸã‚Š1ã¤ã®Dockerã‚³ãƒ³ãƒ†ãƒŠï¼ˆ`/workspace/project`ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆï¼‰
- å®Œäº†ã¾ãŸã¯ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- ç’°å¢ƒå¤‰æ•°æ³¨å…¥ã¨èªè¨¼æƒ…å ±ãƒã‚¦ãƒ³ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆ

## æ—¢çŸ¥ã®èª²é¡Œ

### ç›¸å¯¾ãƒ‘ã‚¹ã®è§£æ±º
ã‚¿ã‚¹ã‚¯è¨­å®šã§ç›¸å¯¾ãƒ‘ã‚¹`"."`ã‚’ä½¿ç”¨ã™ã‚‹ã¨Dockerãƒã‚¦ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ï¼š
```
invalid mount path: '.' mount path must be absolute
```

**å¯¾å¿œ**: çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€workerå®Ÿè¡Œå‰ã«ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¹ã‚’çµ¶å¯¾ãƒ‘ã‚¹ã«è§£æ±ºã—ã¦ãã ã•ã„ï¼ˆ`worker/executor.go`ã§`filepath.Abs`ã‚’ä½¿ç”¨ï¼‰ã€‚

## ç’°å¢ƒå¤‰æ•°

```bash
# Meta-agentç”¨ï¼ˆOpenAI APIï¼‰
export OPENAI_API_KEY="sk-..."

# Worker agentç”¨ï¼ˆauth.jsonæœªä½¿ç”¨ã®å ´åˆï¼‰
export CODEX_API_KEY="..."
```

## ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¡ãƒ¢ãƒªä½“ç³»

**â˜… [docs/CLAUDE.md](docs/CLAUDE.md)** - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´ç†ãƒ«ãƒ¼ãƒ«ãƒ»å‘½åè¦å‰‡ãƒ»æ‹¡å¼µã‚¬ã‚¤ãƒ‰ï¼ˆãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è²¬å‹™åˆ†æ‹…ï¼‰

å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†… `CLAUDE.md` ã¯æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼š**è²¬å‹™** â†’ **ä¸»è¦æ¦‚å¿µ** â†’ **å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³** â†’ **ãƒ†ã‚¹ãƒˆæˆ¦ç•¥** â†’ **æ‹¡å¼µãƒ»æ—¢çŸ¥å•é¡Œ**

### å®Ÿè£…å±¤ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

| å±¤ | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | è²¬å‹™ | è©³ç´° |
|----|---------|----|------|
| **Core** | core | FSMãƒ»TaskContextãƒ»çŠ¶æ…‹é·ç§» | [CLAUDE.md](internal/core/CLAUDE.md) |
| **Core** | meta | LLMé€šä¿¡ãƒ»YAMLãƒ—ãƒ­ãƒˆã‚³ãƒ« | [CLAUDE.md](internal/meta/CLAUDE.md) |
| **Core** | worker | CLIå®Ÿè¡Œãƒ»Docker ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ | [CLAUDE.md](internal/worker/CLAUDE.md) |
| **Util** | note | Task Noteç”Ÿæˆãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | [CLAUDE.md](internal/note/CLAUDE.md) |
| **Util** | mock | ãƒ†ã‚¹ãƒˆãƒ€ãƒ–ãƒ«ãƒ»FuncFieldæ³¨å…¥ | [CLAUDE.md](internal/mock/CLAUDE.md) |
| **Config** | pkg/config | YAMLè¨­å®šã‚¹ã‚­ãƒ¼ãƒ | [CLAUDE.md](pkg/config/CLAUDE.md) |

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ï¼ˆé‡è¦ï¼‰

**[test/CLAUDE.md](test/CLAUDE.md)** - 4æ®µéšãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã€ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ã€ç²¾åº¦ç®¡ç†ã€å®Œå…¨ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½“ç³»

### AIé–‹ç™ºè€…å‘ã‘ï¼ˆãƒ¡ãƒ¢ãƒªãƒ»æ“ä½œã‚¬ã‚¤ãƒ‰ï¼‰
- **[CLAUDE.md](CLAUDE.md)** (ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ãƒ»æ“ä½œã‚¬ã‚¤ãƒ‰
- **[docs/CLAUDE.md](docs/CLAUDE.md)** â˜…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´ç†ãƒ«ãƒ¼ãƒ«ãƒ»å‘½åè¦å‰‡ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è²¬å‹™
- **å„internal/*/CLAUDE.md** - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å®Ÿè£…ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ï¼ˆæ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆçµ±ä¸€ï¼‰
- **[test/CLAUDE.md](test/CLAUDE.md)** - ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ãƒ»ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ãƒ»ç²¾åº¦ç®¡ç†

### docs/ - è¨­è¨ˆãƒ»ä»•æ§˜ãƒ»é–‹ç™ºã‚¬ã‚¤ãƒ‰
| ãƒ•ã‚¡ã‚¤ãƒ« | å¯¾è±¡ | ç”¨é€” |
|---------|------|------|
| [CLAUDE.md](docs/CLAUDE.md) | AIé–‹ç™ºè€… | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´ç†ãƒ«ãƒ¼ãƒ«ãƒ»å‘½åè¦å‰‡ |
| [AgentRunner-architecture.md](docs/AgentRunner-architecture.md) | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ | ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆãƒ»ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢ä¿‚ |
| [agentrunner-spec-v1.md](docs/agentrunner-spec-v1.md) | é–‹ç™ºè€…ãƒ»PO | MVPä»•æ§˜ãƒ»APIãƒ»ã‚¹ã‚­ãƒ¼ãƒ |
| [AgentRunner-impl-design-v1.md](docs/AgentRunner-impl-design-v1.md) | å®Ÿè£…è€… | Goå®Ÿè£…è¨­è¨ˆãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆ†å‰² |
| [TESTING.md](docs/TESTING.md) | ãƒ†ã‚¹ã‚¿ãƒ¼ãƒ»é–‹ç™ºè€… | ãƒ†ã‚¹ãƒˆãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ |
| [CODEX_TEST_README.md](docs/CODEX_TEST_README.md) | é–‹ç™ºè€… | Codexçµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¬ã‚¤ãƒ‰ |

### ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ï¼ˆä¸å¤‰ï¼‰
- **[README.md](README.md)** - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç´¹ä»‹ï¼ˆå¤‰æ›´ç¦æ­¢ï¼‰
- **[GEMINI.md](GEMINI.md)** - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèƒŒæ™¯ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆå¤‰æ›´ç¦æ­¢ï¼‰

## é–‹ç™ºãƒãƒ¼ãƒˆ

- **è¨€èª**: ã‚³ãƒ¡ãƒ³ãƒˆãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¯æ—¥æœ¬èªã€ã‚³ãƒ¼ãƒ‰ï¼ˆé–¢æ•°ãƒ»å¤‰æ•°åï¼‰ã¯è‹±èª
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†**: â˜…[docs/CLAUDE.md](docs/CLAUDE.md)ã§å‘½åè¦å‰‡ãƒ»è²¬å‹™åˆ†æ‹…ã‚’ä¸€å…ƒç®¡ç†
- **ãƒ†ã‚¹ãƒˆ**: ä¾å­˜æ€§æ³¨å…¥ã¨ãƒ¢ãƒƒã‚¯ã‚’ä½¿ç”¨ï¼›ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆã§ä¸å¤‰æ¡ä»¶ã‚’æ¤œè¨¼
- **ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–**: ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ï¼ˆ-tags=docker,codexï¼‰ã‚’ä½¿ç”¨ã—ãŸæ®µéšçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **ãƒ­ã‚®ãƒ³ã‚°**: æ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆlog/slogï¼‰å°å…¥æ¸ˆã¿
- **ä¾å­˜é–¢ä¿‚**: Go 1.23ä»¥ä¸Šã€Dockerã€OpenAI API

---

## æ”¹å–„å±¥æ­´ï¼ˆPhase 1-3ï¼‰2025å¹´11æœˆ

### Phase 1-3 å®Œäº†æ™‚ã®æˆæœ

| é …ç›® | æ”¹å–„å‰ | æ”¹å–„å¾Œ | å‘ä¸Šåº¦ |
|------|-------|-------|--------|
| **å…¨ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸** | 26.8% | 33.9% | **+7.1pp** â¬†ï¸ |
| **Metaå±¤ã‚«ãƒãƒ¬ãƒƒã‚¸** | 0% | 28.0% | **+28.0pp** âœ¨ |
| **ãƒ†ã‚¹ãƒˆæ•°** | 63å€‹ | 79å€‹ | **+16å€‹** ğŸ¯ |
| **extractYAML** | 0% | 100% | **æ–°è¦å®Ÿè£…** ğŸ† |

### Phase 1: æœ¬ç•ªå®‰å®šæ€§å‘ä¸Š âœ…

1. **YAMLæŠ½å‡ºãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…**
   - LLMãŒMarkdown code blockã§å¿œç­”ã—ãŸå ´åˆã®ãƒ‘ãƒ¼ã‚¹å¯¾å¿œ
   - è¤‡æ•°ã®æŠ½å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…ï¼ˆæ­£è¦è¡¨ç¾ã€prefix/suffixå‰Šé™¤ï¼‰
   - 5ã¤ã®ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆè¿½åŠ 

2. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–**
   - `filepath.Abs()` / `io.ReadAll()` ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
   - éæ¨å¥¨APIï¼ˆ`ioutil`ï¼‰ã‚’`os`/`io`ã«ç½®ãæ›ãˆ

3. **Meta-agenté€šä¿¡å±¤ãƒ†ã‚¹ãƒˆè¿½åŠ **
   - `internal/meta/client_test.go` æ–°è¦ä½œæˆ
   - 11å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
   - ã‚«ãƒãƒ¬ãƒƒã‚¸: 0% â†’ 28.0%

### Phase 2: é–‹ç™ºä½“é¨“å‘ä¸Š âœ…

4. **Makefileè¿½åŠ **
   - `make build`, `make test-unit`, `make coverage` ç­‰
   - ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰é–‹ç™ºã‚¿ã‚¹ã‚¯å®Ÿè¡Œ

5. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°**
   - CLAUDE.md ã«æ”¹å–„å±¥æ­´ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 

### Phase 3: Docker Sandbox æ§‹é€ åŒ– âœ…

6. **Sandbox API ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åŒ–æ¤œè¨**
   - DockerClient ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
   - ãƒ†ã‚¹ãƒˆç”¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰æ¤œè¨
   - æ—¢å­˜ test/sandbox ãƒ†ã‚¹ãƒˆï¼ˆ7ãƒ†ã‚¹ãƒˆï¼‰ã§å®Ÿé‹ç”¨ã‚«ãƒãƒ¼

### æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã®äºˆå®šï¼ˆå°†æ¥æ”¹å–„ï¼‰

- [ ] mainé–¢æ•°ãƒ†ã‚¹ãƒˆ
- [ ] Docker Sandbox ãƒ¢ãƒƒã‚¯åŒ–ãƒ†ã‚¹ãƒˆï¼ˆ+8-12%æœŸå¾…ï¼‰
- [ ] completion_assessmentå®Ÿè£…ï¼ˆVALIDATINGçŠ¶æ…‹ï¼‰
- [ ] æ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆlog/slogï¼‰å°å…¥
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥

**ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—**:
- ç¾çŠ¶: 33.9% âœ…
- çŸ­æœŸ: 45% ï¼ˆmain + Sandbox ãƒ†ã‚¹ãƒˆï¼‰
- ä¸­æœŸ: 55% ï¼ˆç«¶äº‰å„ªä½æ€§ç¢ºä¿ï¼‰
- é•·æœŸ: 60%+ ï¼ˆæœ¬ç•ªå¯¾å¿œæº–å‚™å®Œäº†ï¼‰

## é–‹ç™ºæ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆPhase 1-5 å®Œäº†ï¼‰

### Phase 1: æ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°å®Ÿè£… âœ…
- **log/slog å°å…¥**: cmd/agent-runner/main.go, internal/core/runner.go ã§ slog ã‚’ä½¿ç”¨
- **ãƒ­ã‚®ãƒ³ã‚°ãƒ¬ãƒ™ãƒ«**: INFO/WARN/ERROR ã«çµ±ä¸€
- **æ”¹å–„åŠ¹æœ**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¯è¦–åŒ–ã€æœ¬ç•ªãƒ‡ãƒãƒƒã‚°æ€§å‘ä¸Š

### Phase 2: mainé–¢æ•°ãƒ†ã‚¹ãƒˆè¿½åŠ  âœ…
- **cmd/agent-runner/main_test.go æ–°è¦ä½œæˆ**: 10å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- **ãƒ†ã‚¹ãƒˆé …ç›®**: YAMLè§£æã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ç’°å¢ƒå¤‰æ•°ã€I/Oæ“ä½œ
- **é–¢é€£æ”¹å–„**: mock ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°è¿½åŠ ï¼ˆNewMockMetaClientç­‰ï¼‰

### Phase 3: Metaå±¤ã‚«ãƒãƒ¬ãƒƒã‚¸æ‹¡å¤§ âœ…
- **internal/meta/client_test.go æ‹¡å¼µ**: æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 28% â†’ 30.7%ï¼ˆæ®µéšçš„æ”¹å–„ï¼‰
- **ãƒ†ã‚¹ãƒˆé …ç›®**: YAMLæŠ½å‡ºã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œè¨¼

### Phase 4: test.commandå®Ÿè£… âœ…
- **internal/core/runner.go**: runTestCommand() ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
- **æ©Ÿèƒ½**: ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã®è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **è¨­å®š**: Task.Test.Command, Task.Test.Cwd ã§åˆ¶å¾¡
- **çµæœ**: TaskContext.TestResult ã«è¨˜éŒ²ã€Task Note ã«å‡ºåŠ›

### Phase 5: golangci-lintè¨­å®š âœ…
- **.golangci.yml ä½œæˆ**: å®Ÿç”¨çš„ãªlinterè¨­å®šï¼ˆ9å€‹æœ‰åŠ¹åŒ–ï¼‰
- **ã‚¨ãƒ©ãƒ¼ä¿®æ­£**: json.Marshal, yaml.Marshal, Close() ã®ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯æ”¹å–„
- **è¨­å®š**: check-blank: false ã§é–‹ç™ºåŠ¹ç‡ã¨ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ç¢ºä¿
- **å®Ÿè¡Œ**: Makefile ã® make lint ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå¯¾å¿œ

### Phase A: Coreå±¤ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆæœ€å°å·¥æ•°æœ€å¤§åŠ¹æœå®Ÿè£…ï¼‰âœ…
- **internal/core/runner_test.go æ‹¡å¼µ**: 4å€‹ã®æ–°ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
  - TestRunner_TestCommand_Successï¼ˆæˆåŠŸã‚±ãƒ¼ã‚¹ï¼‰
  - TestRunner_TestCommand_Failureï¼ˆå¤±æ•—ã‚±ãƒ¼ã‚¹ï¼‰
  - TestRunner_TestCommand_NotConfiguredï¼ˆæœªè¨­å®šæ™‚ã®æŒ™å‹•ï¼‰
  - TestRunner_TestCommand_RelativeCwdï¼ˆç›¸å¯¾ãƒ‘ã‚¹Cwdå‡¦ç†ï¼‰
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 44.2% â†’ 77.9% (Coreå±¤) | **å…¨ä½“**: 34.2% â†’ 38.5%

### Phase B: Worker/Executorã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆè¿½åŠ  âœ…
- **internal/worker/executor_test.go æ‹¡å¼µ**: 3å€‹ã®æ–°ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ 
  - TestExecutor_RunWorker_SandboxStartErrorï¼ˆèµ·å‹•å¤±æ•—ï¼‰
  - TestExecutor_RunWorker_SandboxExecErrorï¼ˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼è¨˜éŒ²ï¼‰
  - TestExecutor_RunWorker_EnvironmentVariablesï¼ˆç’°å¢ƒå¤‰æ•°ä¼æ’­ï¼‰
- **åŠ¹æœ**: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®è‡ªå‹•æ¤œè¨¼ã€æœ¬ç•ªå®‰å®šæ€§å‘ä¸Š
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: **å…¨ä½“**: 38.5% â†’ 43.4% âœ…

### æ•´ä½“ã‚«ãƒãƒ¬ãƒƒã‚¸æ¨ç§»

| Phase | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | æ”¹å–„å†…å®¹ | ã‚«ãƒãƒ¬ãƒƒã‚¸ |
|-------|--------------|--------|-----------|
| 1-5 | å…¨å±¤çµ±åˆ | ãƒ­ã‚®ãƒ³ã‚°ãƒ»ãƒ†ã‚¹ãƒˆãƒ»linter | 26.8% â†’ 34.2% |
| A | core | test.command ãƒ†ã‚¹ãƒˆ | 44.2% â†’ 77.9% |
| B | worker | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ | - â†’ 23.4%+ |
| **æœ€çµ‚** | **å…¨ä½“** | MVPæº–å‚™å®Œäº† | **34.2% â†’ 43.4%** âœ… |

**ç¾çŠ¶**: 43.4% | **é”æˆ**: ç›®æ¨™42-45%ç¯„å›²å†… âœ… | **æ¬¡æ®µéš**: Priority Mediumé …ç›®ï¼ˆ45-55%ï¼‰

## ãƒ†ã‚¹ãƒˆå®Ÿè£…çŠ¶æ³ã¨æ”¹å–„å±¥æ­´

**è©³ç´°ã¯ [test/CLAUDE.md](test/CLAUDE.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

ãƒ†ã‚¹ãƒˆé–¢é€£ã®è©³ç´°ãªå®Ÿè£…çŠ¶æ³ã€ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã€ç²¾åº¦ç®¡ç†æ‰‹æ³•ã¯ã€test/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã® CLAUDE.md ã«ä¸€å…ƒç®¡ç†ã•ã‚Œã¦ã„ã¾ã™ï¼š

- **ãƒ†ã‚¹ãƒˆå®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º**: Phase 1-5 + Phase A-B å®Œäº†ï¼ˆå…¨å±¤çµ±åˆãƒ†ã‚¹ãƒˆå®Œæˆï¼‰
- **ãƒ†ã‚¹ãƒˆçµ±è¨ˆ**: 83+ ãƒ†ã‚¹ãƒˆï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ»Mockãƒ»Dockerãƒ»Codexãƒ»çµ±åˆï¼‰
- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 26.8% â†’ 43.4% âœ… ï¼ˆæœ€å°å·¥æ•°ã§ç›®æ¨™é”æˆï¼‰
- **æ®µéšçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ã«ã‚ˆã‚‹æ®µéšçš„å®Ÿè¡Œæˆ¦ç•¥
- **ç²¾åº¦ç®¡ç†**: ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã€ä¸å¤‰æ¡ä»¶ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆæˆ¦ç•¥
- **ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: Dockerã€èªè¨¼ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç­‰ã®æ—¢çŸ¥å•é¡Œã¨å¯¾å¿œ
- **å“è³ªæŒ‡æ¨™**: Coreå±¤ 77.9% | Noteå±¤ 81.2% | Workerå±¤ 23.4%+ | Metaå±¤ 28.0%

test/CLAUDE.md ã§åŒ…æ‹¬çš„ã«ç®¡ç†ãƒ»æ›´æ–°ã•ã‚Œã¦ã„ã¾ã™ã€‚
