# GEMINI.md

## プロジェクト概要

`agent-runner` は、AI ベースのワーカーエージェント（例：コーディングアシスタント）を管理し、タスクを自律的に実行するために設計されたメタエージェントおよびオーケストレーションレイヤーです。Docker サンドボックス内で安全かつ再現可能な方法でワーカーエージェントをオーケストレーションすることにより、人間の介入を最小限に抑えることを目的としています。タスク完了後、タスクの「メモリ」を Markdown ファイルとして生成し、他のエージェントや人間がコンテキストとして利用できるようにします。

アーキテクチャは 3 つの主要コンポーネントで構成されています：

- **Meta-agent (LLM):** タスクを計画し、次のアクションを決定し、結果を評価する「頭脳」です。
- **AgentRunner Core:** Meta-agent の決定を実行する「手」です。Docker サンドボックスの管理、Worker CLI の実行、タスク状態の管理、Markdown ノートの生成を行います。
- **Worker Agents (CLI):** サンドボックス内で実際の作業（コーディング、テスト実行、git 操作など）を行う「実行者」です。

システムは、コンポーネント間の構造化されたプロトコルと指示に YAML を使用し、タスクのライフサイクルと結果の永続的な記録として Markdown ファイルを生成します。

## ビルドと実行

このプロジェクトは標準的な Go アプリケーションです。

### アプリケーションのビルド

`agent-runner` バイナリをビルドするには、以下を実行します：

```bash
go build ./cmd/agent-runner
```

### アプリケーションの実行

`agent-runner` は標準入力から提供される YAML ファイルからタスク設定を読み込みます。

```bash
./agent-runner < task.yaml
```

サンプルタスク設定は `sample_task_go.yaml` にあります。

### テストの実行

プロジェクトのテストを実行するには、標準的な Go テストコマンドを使用します：

```bash
go test ./...
```

## 開発の規約

- **設定:** タスク設定は YAML ファイルで定義されます。
- **通信プロトコル:** Core と Meta-agent 間の通信は YAML ベースのプロトコルで処理されます。
- **タスク出力:** 各タスクの結果と「メモリ」は Markdown ファイルとして保存され、通常は `.agent-runner/` ディレクトリに格納されます。
- **サンドボックス化:** すべてのワーカーアクションは、隔離と再現性のために Docker コンテナ内で実行されます。`sandbox/Dockerfile` はこれらのワーカーのベース環境を定義します。
- **モジュール性:** プロジェクトはいくつかの内部パッケージ（`core`, `meta`, `worker`, `note`）と、共有設定用の `pkg` ディレクトリに整理されており、一般的な Go の慣習に従っています。
- **ドキュメント:** 詳細な仕様と設計は `docs/` ディレクトリに体系的に整理されています。[docs/README.md](docs/README.md) を参照してください。

## インタラクションポリシー

- **言語:** 常に日本語でコミュニケーションを行ってください。

## 重要：作業前の確認事項

それぞれのディレクトリに配置されている CLAUDE.md は必ず作業前に調査、確認、理解して作業に進んでください。また、必ず作業対象のディレクトリより上位のディレクトリは全て遡ってこのルールの対象とします。
